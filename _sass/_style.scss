/* =======================
   Fomties — Base Styles
   (drop in as a full replacement)
   ======================= */

/* ---- Tokens ---- */
$color-primary: hsl(0, 3%, 6%);        // #100f0f
$color-text: hsl(0, 0%, 20%);          // body text
$color-subtext: hsl(50, 3%, 42%);      // #6f6e69
$color-border: hsl(46, 20%, 79%);      // #d4cfbf
$color-box-background: hsl(48, 100%, 97%); // #fffcf0
$color-accent-blue: #b0cef2;           // link hover/outline
$border-radius: 4px;
$font-family: -apple-system, BlinkMacSystemFont, Segoe UI, Helvetica, Arial,
  sans-serif, Apple Color Emoji, Segoe UI Emoji, Segoe UI Symbol;

/* ---- Page background (light) ---- */
html { background-color: #FAF4E5; }     /* light paper */
body {
  box-sizing: content-box;
  font-family: $font-family;
  margin: 0 auto;
  line-height: 1.7;
  padding: 4vh 6vw;
  overflow-x: hidden;
  color: $color-text;
  background: transparent;              /* body blends with html */
  font-size: 1rem;
  max-width: 37em;

  @media (min-width: 820px) { font-size: 1.2rem; }
}

/* ---- Basics ---- */
time { display: block; color: $color-subtext; margin: .5em 0 1em; }
footer { margin: 2em 0; font-size: .8em; color: mix($color-text, white, 80%); padding-top: 1em; }
img { max-width: 100%; display: block; margin: 0 auto; max-height: 75vh; border-radius: $border-radius; }
blockquote {
  padding: 1.5em; margin: 0; font-size: .88em; background: $color-box-background; border-radius: $border-radius;
  p { margin: 0; }
}
hr { width: 100%; border: 0; height: 1px; margin: 1.5em 0; background: $color-border; }
h1,h2,h3,h4,h5,h6 { line-height: 1.3; margin-bottom: 0; padding-bottom: 0; }

/* =======================
   Links (Kepano-like)
   ======================= */
a, a:visited {
  color: $color-primary;
  background: transparent !important;   /* no purple/beige box */
  border: 0 !important;
  padding: 0 !important;
  text-decoration: underline;
  text-decoration-thickness: 1px;
  text-underline-offset: .08em;
  text-decoration-color: $color-border; /* subtle by default */
  transition: color 200ms ease, text-decoration-color 200ms ease;
}
a:hover {
  color: $color-accent-blue !important;
  text-decoration-color: $color-accent-blue !important;
}

/* Internal links / footnotes: underline only (no arrow) */
a.internal-link, a.footnote, a.reversefootnote { text-decoration: underline; }
a.internal-link::after, a.footnote::after, a.reversefootnote::after { content: "" !important; }

/* Ghost/uncreated notes: grey + dotted, never blue */
.invalid-link {
  color: mix($color-text, white, 50%) !important;
  background: transparent !important;
  text-decoration: none !important;
  border-bottom: 1px dotted $color-border !important;
  cursor: not-allowed;
}
.invalid-link:hover { color: mix($color-text, white, 50%) !important; border-bottom-color: $color-border !important; }
.invalid-link-brackets { display: none; }

/* =======================
   Layout bits
   ======================= */
nav { margin: 1em 0 3em; }
#notes-entry-container {
  display: grid; grid-gap: 2em; grid-template-areas: "content" "side";
  @media (min-width: 700px) { grid-template-columns: 3fr 1fr; grid-template-areas: "content side"; }
}
.backlink-box { background: $color-box-background; padding: 1em; border-radius: $border-radius; }
code { background: #f5f5f5; padding: .1em .2em; border-radius: 4px; }

/* ---- Header / nav ---- */
.site-header { border-bottom: 1px solid $color-border; margin-bottom: 2rem; }
.site-nav {
  max-width: 37em; margin: 0 auto; padding: 1rem 0;
  display: flex; align-items: center; justify-content: space-between;
}
.site-brand { text-decoration: none; border: 0; font-weight: normal; color: $color-primary; }
.site-links { display: flex; align-items: center; }
.site-nav a { border-bottom: 0; text-decoration: none; }
.site-links a { margin-left: 1rem; }

/* ---- Footer & subscribe ---- */
.site-footer { border-top: 1px solid $color-border; margin: 4rem 0 2rem; padding-top: 1.5rem; font-size: .9em; color: mix($color-text, white, 75%); }
.footer-wrap { max-width: 37em; margin: 0; text-align: left; }
.footer-logo-link { display: inline-block; border: 0; }
.footer-logo { max-height: 40px; display: block; margin: 1.25rem 0 0; border-radius: 50%; }

/* ConvertKit inline form */
.site-footer .formkit-form.subscribe-inline { background: transparent !important; border: 0 !important; box-shadow: none !important; padding: 0 !important; }
.site-footer .subscribe-inline { display: flex; align-items: center; gap: .75rem; margin: 1rem 0 2rem; }
.site-footer .subscribe-inline .formkit-input {
  flex: 1 1 24rem; min-width: 16em; background: transparent !important; color: $color-text !important;
  border: 0 !important; box-shadow: none !important; border-radius: 0 !important;
  border-bottom: 1px solid $color-border !important; padding: .6rem 0 !important; outline: none !important;
}
.site-footer .subscribe-inline .formkit-input::placeholder { color: mix($color-text, white, 65%) !important; }
.site-footer .subscribe-inline .formkit-input:focus { border-bottom-color: $color-primary !important; }
.site-footer .subscribe-inline .formkit-submit {
  appearance: none !important; border: 0 !important; background: $color-primary !important; color: #fff !important;
  padding: .55rem 1rem !important; line-height: 1 !important; border-radius: $border-radius !important; cursor: pointer !important; white-space: nowrap !important; box-shadow: none !important;
}
.site-footer .subscribe-inline .formkit-submit:hover { filter: brightness(.95); }
.site-footer .formkit-powered-by,
.site-footer .formkit-powered-by-convertkit-container { display: none !important; }
@media (max-width: 600px) {
  .site-footer .subscribe-inline { flex-direction: column; align-items: flex-start; gap: .5rem; }
  .site-footer .subscribe-inline .formkit-input { flex-basis: 100%; }
}

/* =======================
   Dark theme (html.theme-dark)
   ======================= */
.theme-dark,
.theme-dark html,
.theme-dark body { background-color: #333333; color: #FAF4E5; }

.theme-dark .site-header,
.theme-dark .site-footer,
.theme-dark .site-nav,
.theme-dark .wrapper,
.theme-dark footer { background: transparent !important; }

.theme-dark .site-header { border-bottom: 1px solid #555; }
.theme-dark .site-footer { border-top:    1px solid #555; }
.theme-dark hr           { background:    #555; }

.theme-dark a { color: #FAF4E5; text-decoration-color: #666; background: transparent; }
.theme-dark a:hover { color: #B0CEF2; text-decoration-color: #B0CEF2; }

/* Ghost notes on dark */
.theme-dark .invalid-link { color: #BDBDBD !important; border-bottom-color: #666 !important; }
.theme-dark .invalid-link:hover { color: #B0CEF2 !important; border-bottom-color: #B0CEF2 !important; }

/* Footer form on dark */
.theme-dark .subscribe-inline .formkit-input {
  color: #FAF4E5 !important; border-bottom: 1px solid #666 !important; background: transparent !important;
}
.theme-dark .subscribe-inline .formkit-input::placeholder { color: #BDBDBD !important; }
.theme-dark .subscribe-inline .formkit-submit { background: #FAF4E5 !important; color: #333333 !important; }


/* =======================
   Theme toggle (clean)
   ======================= */
/* HTML:
<button id="theme-toggle" type="button" role="switch" aria-label="toggle dark mode">
  <span class="theme-toggle-slide"></span>
  <span class="theme-toggle-switch"></span>
</button>
*/

#theme-toggle{
  display:inline-block;
  vertical-align:middle;
  position:relative;
  width:40px; height:22px;
  border:0; padding:0; margin-left:1rem;
  background:transparent; cursor:pointer;
  line-height:0;
}
.theme-toggle-slide{
  position:absolute; inset:0;
  border-radius:9999px;
  background:transparent;
  border:1px solid $color-border;
}
.theme-toggle-switch{
  position:absolute; top:2px; left:2px;
  width:18px; height:18px; border-radius:50%;
  background:$color-text;                 /* dark knob in light theme */
  transition:left 150ms linear, background 150ms linear, color 150ms linear;
  color:#FAF4E5;                          /* icon color in light mode */
}
/* tiny icon centered inside the knob (uses SVG masks for crisp look) */
.theme-toggle-switch::before{
  content:'';
  position:absolute; left:50%; top:50%;
  width:12px; height:12px; transform:translate(-50%,-50%);
  background: currentColor;
  -webkit-mask: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"><path d="M12 4a1 1 0 0 1 1 1v1a1 1 0 1 1-2 0V5a1 1 0 0 1 1-1Zm0 9a4 4 0 1 0 0-8 4 4 0 0 0 0 8Zm6.364 2.95.707.707a1 1 0 1 0 1.414-1.414l-.707-.707a1 1 0 0 0-1.414 1.414Z"/></svg>') center/contain no-repeat;
          mask: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"><path d="M12 4a1 1 0 0 1 1 1v1a1 1 0 1 1-2 0V5a1 1 0 0 1 1-1Zm0 9a4 4 0 1 0 0-8 4 4 0 0 0 0 8Zm6.364 2.95.707.707a1 1 0 1 0 1.414-1.414l-.707-.707a1 1 0 0 0-1.414 1.414Z"/></svg>') center/contain no-repeat;
}
/* Dark mode: slide right, invert colors, moon icon */
.theme-dark .theme-toggle-slide { border-color:#575653; }
.theme-dark .theme-toggle-switch{
  left:20px; background:#FAF4E5; color:#333333;
}
.theme-dark .theme-toggle-switch::before{
  -webkit-mask: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"><path d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z"/></svg>') center/contain no-repeat;
          mask: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"><path d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z"/></svg>') center/contain no-repeat;
}

/* =======================
   Link preview popover (light + dark)
   ======================= */

/* light */
#popover-wrapper{
  background: #FFFCF0 !important;   /* paper */
  color: $color-primary !important;
  border: 1px solid $color-border !important;
  border-radius: 6px !important;
  box-shadow: 0 5px 20px rgba(16,15,15,.2) !important;
}
#popover-content{ color: inherit !important; }
#popover-content a{
  color: inherit !important;
  text-decoration: underline;
  text-decoration-color: $color-border;
}

/* dark */
.theme-dark #popover-wrapper{
  background: #2b2b2b !important;   /* dark card */
  color: #FAF4E5 !important;
  border: 1px solid #555 !important;
  box-shadow: 0 5px 20px rgba(0,0,0,.65) !important;
}
.theme-dark #popover-content a{
  color: inherit !important;
  text-decoration-color: #888;
}

/* External-link arrow (works everywhere, including .plain) */
a[href^="http://"]:not(.internal-link):not(.footnote):not(.reversefootnote)::after,
a[href^="https://"]:not(.internal-link):not(.footnote):not(.reversefootnote)::after,
a[href^="//"]:not(.internal-link):not(.footnote):not(.reversefootnote)::after {
  content: "↗";
  font-size: 0.75em;
  position: relative;
  top: -0.35em;
  margin-left: 0.15em;
  color: currentColor;
  display: inline-block;
}

/* Put the arrow back inside the footer (overrides your footer reset) */
.site-footer a[href^="http://"]:not(.internal-link):not(.footnote):not(.reversefootnote)::after,
.site-footer a[href^="https://"]:not(.internal-link):not(.footnote):not(.reversefootnote)::after,
.site-footer a[href^="//"]:not(.internal-link):not(.footnote):not(.reversefootnote)::after {
  content: "↗" !important;
}

/* (Optional) Don’t show the arrow for your own domain even if it’s absolute URLs */
a[href^="https://notes.ryeones.com"]:after,
a[href^="http://notes.ryeones.com"]:after { content: none !important; }