/* --- theme colours (HSL) --- */
$color-primary: hsl(0, 3%, 6%);        // #100f0f
$color-text: hsl(0, 0%, 20%);           // main body text
$color-subtext: hsl(50, 3%, 42%);      // #6f6e69 - secondary text
$color-border: hsl(46, 20%, 79%);      // #d4cfbf - subtle borders/dividers
$color-box-background: hsl(48, 100%, 97%); // #fffcf0 - light paper background for blocks
$border-radius: 4px;
$font-family: -apple-system, BlinkMacSystemFont, Segoe UI, Helvetica, Arial,
  sans-serif, Apple Color Emoji, Segoe UI Emoji, Segoe UI Symbol;

body {
  box-sizing: content-box;
  font-family: $font-family;
  margin: 0 auto;
  line-height: 1.7;
  padding: 4vh 6vw;
  overflow-x: hidden;
  color: $color-text;
  background-color: hsl(43, 68%, 94%); // #FAF4E5
  font-size: 1rem;
  max-width: 37em;

  @media (min-width: 820px) {
    font-size: 1.2rem;
  }
}

time {
  display: block;
  color: $color-subtext;
  margin: 0.5em 0 1em;
}

footer {
  margin: 2em 0;
  font-size: 0.8em;
  color: mix($color-text, white, 80%);
  padding-top: 1em;
}

img {
  max-width: 100%;
  display: block;
  margin: 0 auto;
  max-height: 75vh;
  border-radius: $border-radius;
}

blockquote {
  padding: 1.5em;
  margin: 0;
  font-size: 0.88em;
  background: $color-box-background;
  border-radius: $border-radius;

  p {
    margin: 0;
  }
}

hr {
  width: 100%;
  border: 0;
  height: 1px;
  margin: 1.5em 0;
  background: $color-border;
}

h1,
h2,
h3,
h4,
h5,
h6 {
  line-height: 1.3;
  margin-bottom: 0;
  padding-bottom: 0;
}

a {
  transition: background 300ms;
  padding: 0 0.1em;
  text-decoration: none;
  border-bottom: 1px solid $color-border;
  color: $color-primary;
  &:hover {
    color: black !important;
    background: #fffaf1;
  }
  &:after {
    position: relative;
    top: -0.5em;
    font-size: 0.7em;
    content: "↗";
    color: #aaaaaa;
  }
  &.internal-link:after,
  &.footnote:after,
  &.reversefootnote:after {
    content: "";
  }
}

*:focus {
  background: #ffe8bc !important;
  color: black !important;
}

nav {
  margin: 1em 0 3em;
}

#notes-entry-container {
  display: grid;
  grid-gap: 2em;
  grid-template-areas:
    "content"
    "side";

  @media (min-width: 700px) {
    grid-template-columns: 3fr 1fr;
    grid-template-areas: "content side";
  }
}

.backlink-box {
  background: $color-box-background;
  padding: 1em;
  border-radius: $border-radius;
}

code {
  background: #f5f5f5;
  padding: 0.1em 0.2em;
  border-radius: 4px;
}

.invalid-link {
  color: #444444;
  cursor: help;
  background: #fafafa;
  padding: 0 0.1em;
}

.invalid-link-brackets {
  color: #ccc;
  cursor: help;
}

/* page background already set on body; match footer to it */
.site-footer {
  background-color: hsl(43, 68%, 94%); /* #FAF4E5 */
  border-top: 1px solid $color-border;
  margin: 4rem 0 2rem;
  padding-top: 1.5rem;
  font-size: .9em;
  color: mix($color-text, white, 75%);
}

/* Footer container: align left, not centered */
.footer-wrap {
  max-width: 37em;
  margin: 0;              /* was 0 auto */
  text-align: left;
}

/* No ↗ arrows in the footer */
.site-footer a::after {
  content: none !important;
}

/* Make sure the logo aligns left and ignores global img centring */
.footer-logo {
  display: block;
  max-height: 40px;
  margin: 1.25rem 0 0 0 !important;  /* ensure no auto margins */
  border-radius: 50%;
}

/* -------- ConvertKit inline form (pretty, minimal) -------- */
.site-footer .formkit-form.subscribe-inline {
  background: transparent !important;
  border: 0 !important;
  box-shadow: none !important;
  padding: 0 !important;
}

.site-footer .subscribe-inline {
  display: flex;
  align-items: center;
  gap: .75rem;
  margin: 1rem 0 2rem;
}

/* Input: no box, just an underline; full width on desktop */
.site-footer .subscribe-inline .formkit-input {
  flex: 1 1 24rem;
  min-width: 16em;
  background: transparent !important;
  color: $color-text !important;

  /* kill CK defaults */
  border: 0 !important;
  box-shadow: none !important;
  border-radius: 0 !important;

  /* our style */
  border-bottom: 1px solid $color-border !important;
  padding: .6rem 0 !important;
  outline: none !important;
}

.site-footer .subscribe-inline .formkit-input::placeholder {
  color: mix($color-text, white, 65%) !important;
}

.site-footer .subscribe-inline .formkit-input:focus {
  border-bottom-color: $color-primary !important;
}

/* Button: compact, dark, rounded */
.site-footer .subscribe-inline .formkit-submit {
  appearance: none !important;
  border: 0 !important;
  background: $color-primary !important;
  color: #fff !important;
  padding: .55rem 1rem !important;
  line-height: 1 !important;
  border-radius: $border-radius !important;
  cursor: pointer !important;
  white-space: nowrap !important;
  box-shadow: none !important;
}

.site-footer .subscribe-inline .formkit-submit:hover {
  filter: brightness(.95);
}

/* Hide “Powered by Kit” if CK injects it */
.site-footer .formkit-powered-by,
.site-footer .formkit-powered-by-convertkit-container {
  display: none !important;
}

/* Mobile: stack neatly */
@media (max-width: 600px) {
  .site-footer .subscribe-inline {
    flex-direction: column;
    align-items: flex-start;
    gap: .5rem;
  }
  .site-footer .subscribe-inline .formkit-input {
    flex-basis: 100%;
  }
}

/* If you still see a different background tone, force it transparent */
.site-footer,
.footer-wrap,
.subscribe-inline,
.formkit-form { background: transparent; }

@media (max-width: 600px) {
  .subscribe-inline { flex-direction: column; align-items: flex-start; }
}

/* footer logo */
.footer-logo-link { display: inline-block; border: 0; }
.footer-logo { max-height: 40px; display: block; margin: 1.25rem 0 0; border-radius: 50%; }

/* Header / nav */
.site-header {
  border-bottom: 1px solid $color-border;
  margin-bottom: 2rem;
}
.site-nav {
  max-width: 37em;                 /* 63em for wider header */
  margin: 0 auto;
  padding: 1rem 0;
  display: flex;
  align-items: center;
  justify-content: space-between;  /* left title | right links */
}
/* brand */
.site-brand {
  text-decoration: none;
  border: 0;
  font-weight: normal;
  color: $color-primary;
}
/* right group */
.site-links { display: flex; align-items: center; }
/* remove underline in header; arrows already removed via .internal-link */
.site-nav a { border-bottom: 0; text-decoration: none; }
/* spacing */
.site-links a { margin-left: 1rem; }
#theme-toggle   { margin-left: 1rem; }

/* theme toggle visuals */
#theme-toggle {
  height: 20px;
  width: 36px;
  display: inline-block;
  position: relative;
  border: none;
  background: transparent;
  cursor: pointer;
}
.theme-toggle-slide {
  height: 20px;
  border: 1px solid $color-border;
  border-radius: 24px;
  width: 100%;
  position: absolute;
  background: mix($color-text, white, 92%);
}
.theme-toggle-switch {
  position: absolute;
  z-index: 1;
  top: 1px;
  left: 1px;
  width: 18px;
  height: 18px;
  border-radius: 50%;
  background: $color-text;
  transition: left 120ms linear, background 120ms linear;
}
.theme-dark .theme-toggle-slide { background: mix($color-text, white, 15%); }
.theme-dark .theme-toggle-switch { left: 17px; background: mix($color-text, white, 90%); }

@media (max-width: 700px) {
  .site-nav { padding: .75rem 0; }
  .site-links a { margin-left: .75rem; }
}